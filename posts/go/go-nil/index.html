<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Go Nil - My New Hugo Site</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="olOwOlo" /><meta name="description" content="nil is a frequently (频繁的) used and important predeclared identifier (预定义标识符) in Go. It is the literal representation (代表) of zero values of many kinds of types. Many new Go programmers with experiences of some other popular languages may view nil as the counterpart (相对应) of null (or NULL) in other languages. This is partly right, but there are many differences between nil in Go and null (or NULL) in other languages." />






<meta name="generator" content="Hugo 0.86.0-DEV with theme even" />


<link rel="canonical" href="https://example.org/posts/go/go-nil/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">



<meta property="og:title" content="Go Nil" />
<meta property="og:description" content="nil is a frequently (频繁的) used and important predeclared identifier (预定义标识符) in Go. It is the literal representation (代表) of zero values of many kinds of types. Many new Go programmers with experiences of some other popular languages may view nil as the counterpart (相对应) of null (or NULL) in other languages. This is partly right, but there are many differences between nil in Go and null (or NULL) in other languages." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.org/posts/go/go-nil/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-07T13:21:39+08:00" />
<meta property="article:modified_time" content="2020-12-07T13:21:39+08:00" />

<meta itemprop="name" content="Go Nil">
<meta itemprop="description" content="nil is a frequently (频繁的) used and important predeclared identifier (预定义标识符) in Go. It is the literal representation (代表) of zero values of many kinds of types. Many new Go programmers with experiences of some other popular languages may view nil as the counterpart (相对应) of null (or NULL) in other languages. This is partly right, but there are many differences between nil in Go and null (or NULL) in other languages."><meta itemprop="datePublished" content="2020-12-07T13:21:39+08:00" />
<meta itemprop="dateModified" content="2020-12-07T13:21:39+08:00" />
<meta itemprop="wordCount" content="1462">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go Nil"/>
<meta name="twitter:description" content="nil is a frequently (频繁的) used and important predeclared identifier (预定义标识符) in Go. It is the literal representation (代表) of zero values of many kinds of types. Many new Go programmers with experiences of some other popular languages may view nil as the counterpart (相对应) of null (or NULL) in other languages. This is partly right, but there are many differences between nil in Go and null (or NULL) in other languages."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">My New Hugo Site</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">My New Hugo Site</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
  <div class="post-content">
    <p>nil is a frequently (频繁的) used and important predeclared identifier (预定义标识符) in Go. It is the literal representation (代表) of zero values of many kinds of types. Many new Go programmers with experiences of some other popular languages may view nil as the counterpart (相对应) of null (or NULL) in other languages. This is partly right, but there are many differences between nil in Go and null (or NULL) in other languages.</p>
<p>The remaining (剩下) of this article will list all kinds of facts and details related to nil (nil 相关的事实和细节).</p>
<h3 id="nil-is-a-predeclared-identifier-in-go">nil Is a Predeclared Identifier in Go</h3>
<p>We can use nil without declaring it.</p>
<h3 id="nil-can-represent-zero-values-of-many-types">nil Can Represent Zero Values of Many Types</h3>
<p>In Go, nil can represent zero values of the following kinds of types:</p>
<ul>
<li>pointer types (including type-unsafe ones).</li>
<li>map types.</li>
<li>slice types.</li>
<li>function types.</li>
<li>channel types.</li>
<li>interface types.</li>
</ul>
<h3 id="predeclared-nil-has-not-a-default-type">Predeclared nil Has Not a Default Type</h3>
<p>Each of other (其他每个) predeclared identifiers in Go has a default type. For example,</p>
<ul>
<li>the default types of true and false are both bool type.</li>
<li>the default type of iota is int.</li>
</ul>
<p>But the predeclared nil has not a default type, though it has many possible types. In fact, the predeclared nil is the only untyped value who has not a default type in Go. There must be sufficient information for compiler to deduce the type of a nil from context.</p>
<p>Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#75715e">// There must be sufficient information for
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// compiler to deduce the type of a nil value.
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">_</span> = (<span style="color:#f92672">*</span><span style="color:#66d9ef">struct</span>{})(<span style="color:#66d9ef">nil</span>)
	<span style="color:#a6e22e">_</span> = []int(<span style="color:#66d9ef">nil</span>)
	<span style="color:#a6e22e">_</span> = <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]bool(<span style="color:#66d9ef">nil</span>)
	<span style="color:#a6e22e">_</span> = <span style="color:#66d9ef">chan</span> string(<span style="color:#66d9ef">nil</span>)
	<span style="color:#a6e22e">_</span> = (<span style="color:#66d9ef">func</span>())(<span style="color:#66d9ef">nil</span>)
	<span style="color:#a6e22e">_</span> = <span style="color:#66d9ef">interface</span>{}(<span style="color:#66d9ef">nil</span>)

	<span style="color:#75715e">// These lines are equivalent to the above lines.
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">struct</span>{} = <span style="color:#66d9ef">nil</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> []<span style="color:#66d9ef">int</span> = <span style="color:#66d9ef">nil</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]<span style="color:#66d9ef">bool</span> = <span style="color:#66d9ef">nil</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> <span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">string</span> = <span style="color:#66d9ef">nil</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> <span style="color:#66d9ef">func</span>() = <span style="color:#66d9ef">nil</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> <span style="color:#66d9ef">interface</span>{} = <span style="color:#66d9ef">nil</span>

	<span style="color:#75715e">// This following line doesn&#39;t compile.
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = <span style="color:#66d9ef">nil</span>
}
</code></pre></div><h3 id="predeclared-nil-is-not-a-keyword-in-go">Predeclared nil Is Not a Keyword in Go</h3>
<p>The predeclared nil can be shadowed.</p>
<p>Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#66d9ef">nil</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">123</span>
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#66d9ef">nil</span>) <span style="color:#75715e">// 123
</span><span style="color:#75715e"></span>
	<span style="color:#75715e">// The following line fails to compile,
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// for nil represents an int value now
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// in this scope.
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">int</span> = <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>(BTW, null and NULL in many other languages are also not keywords.)</p>
<h3 id="the-sizes-of-nil-values-with-types-of-different-kinds-may-be-different">The Sizes of Nil Values With Types of Different Kinds May Be Different</h3>
<p>The memory layouts of all values of a type are always the same. nil values of the type are not exceptions (assume the zero values of the type can be represented as nil). The size of a nil value is always the same as the sizes of non-nil values whose types are the same as the nil value. But nil values of different kinds of types may have different sizes.</p>
<p>// =&gt; todo see</p>
<p>Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;unsafe&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">struct</span>{} = <span style="color:#66d9ef">nil</span>
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Sizeof</span>( <span style="color:#a6e22e">p</span> ) ) <span style="color:#75715e">// 8
</span><span style="color:#75715e"></span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">s</span> []<span style="color:#66d9ef">int</span> = <span style="color:#66d9ef">nil</span>
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Sizeof</span>( <span style="color:#a6e22e">s</span> ) ) <span style="color:#75715e">// 24
</span><span style="color:#75715e"></span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">m</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]<span style="color:#66d9ef">bool</span> = <span style="color:#66d9ef">nil</span>
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Sizeof</span>( <span style="color:#a6e22e">m</span> ) ) <span style="color:#75715e">// 8
</span><span style="color:#75715e"></span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">c</span> <span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">string</span> = <span style="color:#66d9ef">nil</span>
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Sizeof</span>( <span style="color:#a6e22e">c</span> ) ) <span style="color:#75715e">// 8
</span><span style="color:#75715e"></span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span> <span style="color:#66d9ef">func</span>() = <span style="color:#66d9ef">nil</span>
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Sizeof</span>( <span style="color:#a6e22e">f</span> ) ) <span style="color:#75715e">// 8
</span><span style="color:#75715e"></span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#66d9ef">interface</span>{} = <span style="color:#66d9ef">nil</span>
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Sizeof</span>( <span style="color:#a6e22e">i</span> ) ) <span style="color:#75715e">// 16
</span><span style="color:#75715e"></span>}
</code></pre></div><p>The sizes are compiler and architecture dependent. The above printed results are for 64-bit architectures and the standard Go compiler. For 32-bit architectures, the printed sizes will be half.</p>
<p>For the standard Go compiler, the sizes of two values of different types of the same kind whose zero values can be represented as the predeclared nil are always the same. For example, the sizes of all values of all different slice types are the same.</p>
<h3 id="two-nil-values-of-two-different-types-may-be-not-comparable">Two Nil Values of Two Different Types May Be Not Comparable</h3>
<p>For example, the two comparisons in the following example both fail to compile. The reason is, in each comparison, neither operand can be implicitly converted to the type of the other.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// Compilation failure reason: mismatched types.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = (<span style="color:#f92672">*</span><span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> (<span style="color:#f92672">*</span><span style="color:#66d9ef">bool</span>)(<span style="color:#66d9ef">nil</span>)         <span style="color:#75715e">// error
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = (<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> (<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">bool</span>)(<span style="color:#66d9ef">nil</span>) <span style="color:#75715e">// error
</span></code></pre></div><p>Please read comparison rules in Go to get which two values can be compared with each other. Typed nil values are not exceptions of the comparison rules.</p>
<p>The code lines in the following example all compile okay.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">IntPtr</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">int</span>
<span style="color:#75715e">// The underlying of type IntPtr is *int.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">IntPtr</span>(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> (<span style="color:#f92672">*</span><span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>)

<span style="color:#75715e">// Every type in Go implements interface{} type.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = (<span style="color:#66d9ef">interface</span>{})(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> (<span style="color:#f92672">*</span><span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>)

<span style="color:#75715e">// Values of a directional channel type can be
</span><span style="color:#75715e">// converted to the bidirectional channel type
</span><span style="color:#75715e">// which has the same element type.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = (<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> (<span style="color:#66d9ef">chan</span><span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>)
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = (<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> (<span style="color:#f92672">&lt;-</span><span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>)
</code></pre></div><h3 id="two-nil-values-of-the-same-type-may-be-not-comparable">Two Nil Values of the Same Type May Be Not Comparable</h3>
<p>In Go, map, slice and function types don&rsquo;t support comparison. Comparing two values, including nil values, of an incomparable types is illegal. The following comparisons fail to compile.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = ([]<span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> ([]<span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>)
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = (<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> (<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>)
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = (<span style="color:#66d9ef">func</span>())(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> (<span style="color:#66d9ef">func</span>())(<span style="color:#66d9ef">nil</span>)
</code></pre></div><p>But any values of the above mentioned incomparable types can be compared with the bare nil identifier.
// The following lines compile okay.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = ([]<span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = (<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_</span> = (<span style="color:#66d9ef">func</span>())(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>
</code></pre></div><h3 id="two-nil-values-may-be-not-equal">Two Nil Values May Be Not Equal</h3>
<p>If one of the two compared nil values is an interface value and the other is not, assume they are comparable, then the comparison result is always false. The reason is the non-interface value will be converted to the type of the interface value before making the comparison. The converted interface value has a concrete dynamic type but the other interface value has not. That is why the comparison result is always false.</p>
<p>Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( (<span style="color:#66d9ef">interface</span>{})(<span style="color:#66d9ef">nil</span>) <span style="color:#f92672">==</span> (<span style="color:#f92672">*</span><span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) ) <span style="color:#75715e">// false
</span></code></pre></div><h3 id="retrieving-elements-from-nil-maps-will-not-panic">Retrieving Elements From Nil Maps Will Not Panic</h3>
<p>Retrieving element from a nil map value will always return a zero element value.</p>
<p>For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( (<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>)[<span style="color:#e6db74">&#34;key&#34;</span>] ) <span style="color:#75715e">// 0
</span><span style="color:#75715e"></span><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( (<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]<span style="color:#66d9ef">bool</span>)(<span style="color:#66d9ef">nil</span>)[<span style="color:#ae81ff">123</span>] )     <span style="color:#75715e">// false
</span><span style="color:#75715e"></span><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>( (<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]<span style="color:#f92672">*</span><span style="color:#66d9ef">int64</span>)(<span style="color:#66d9ef">nil</span>)[<span style="color:#ae81ff">123</span>] )   <span style="color:#75715e">// &lt;nil&gt;
</span></code></pre></div><h3 id="it-is-legal-to-range-over-nil-channels-maps-slices-and-array-pointers">It Is Legal to Range Over Nil Channels, Maps, Slices, and Array Pointers</h3>
<p>The number of loop steps by iterate nil maps and slices is zero.</p>
<p>The number of loop steps by iterate a nil array pointer is the length of its corresponding array type. (However, if the length of the corresponding array type is not zero, and the second iteration is neither ignored nor omitted, the iteration will panic at run time.)</p>
<p>Ranging over a nil channel will block the current goroutine for ever.</p>
<p>For example, the following code will print 0, 1, 2, 3 and 4, then block for ever. Hello, world and Bye will never be printed.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">for</span> <span style="color:#66d9ef">range</span> []int(<span style="color:#66d9ef">nil</span>) {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Hello&#34;</span>)
}

<span style="color:#66d9ef">for</span> <span style="color:#66d9ef">range</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]string(<span style="color:#66d9ef">nil</span>) {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;world&#34;</span>)
}

<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> (<span style="color:#f92672">*</span>[<span style="color:#ae81ff">5</span>]<span style="color:#66d9ef">int</span>)(<span style="color:#66d9ef">nil</span>) {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">i</span>)
}

<span style="color:#66d9ef">for</span> <span style="color:#66d9ef">range</span> <span style="color:#66d9ef">chan</span> bool(<span style="color:#66d9ef">nil</span>) { <span style="color:#75715e">// block here
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Bye&#34;</span>)
}
</code></pre></div><h3 id="invoking-methods-through-non-interface-nil-receiver-arguments-will-not-panic">Invoking Methods Through Non-Interface Nil Receiver Arguments Will Not Panic</h3>
<p>Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Slice</span> []<span style="color:#66d9ef">bool</span>

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">Slice</span>) <span style="color:#a6e22e">Length</span>() <span style="color:#66d9ef">int</span> {
	<span style="color:#66d9ef">return</span> len(<span style="color:#a6e22e">s</span>)
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">Slice</span>) <span style="color:#a6e22e">Modify</span>(<span style="color:#a6e22e">i</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">bool</span>) {
	<span style="color:#a6e22e">s</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#a6e22e">x</span> <span style="color:#75715e">// panic if s is nil
</span><span style="color:#75715e"></span>}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Slice</span>) <span style="color:#a6e22e">DoNothing</span>() {
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Slice</span>) <span style="color:#a6e22e">Append</span>(<span style="color:#a6e22e">x</span> <span style="color:#66d9ef">bool</span>) {
	<span style="color:#f92672">*</span><span style="color:#a6e22e">p</span> = append(<span style="color:#f92672">*</span><span style="color:#a6e22e">p</span>, <span style="color:#a6e22e">x</span>) <span style="color:#75715e">// panic if p is nil
</span><span style="color:#75715e"></span>}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#75715e">// The following selectors will not cause panics.
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">_</span> = ((<span style="color:#a6e22e">Slice</span>)(<span style="color:#66d9ef">nil</span>)).<span style="color:#a6e22e">Length</span>
	<span style="color:#a6e22e">_</span> = ((<span style="color:#a6e22e">Slice</span>)(<span style="color:#66d9ef">nil</span>)).<span style="color:#a6e22e">Modify</span>
	<span style="color:#a6e22e">_</span> = ((<span style="color:#f92672">*</span><span style="color:#a6e22e">Slice</span>)(<span style="color:#66d9ef">nil</span>)).<span style="color:#a6e22e">DoNothing</span>
	<span style="color:#a6e22e">_</span> = ((<span style="color:#f92672">*</span><span style="color:#a6e22e">Slice</span>)(<span style="color:#66d9ef">nil</span>)).<span style="color:#a6e22e">Append</span>

	<span style="color:#75715e">// The following two lines will also not panic.
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">_</span> = ((<span style="color:#a6e22e">Slice</span>)(<span style="color:#66d9ef">nil</span>)).<span style="color:#a6e22e">Length</span>()
	((<span style="color:#f92672">*</span><span style="color:#a6e22e">Slice</span>)(<span style="color:#66d9ef">nil</span>)).<span style="color:#a6e22e">DoNothing</span>()

	<span style="color:#75715e">// The following two lines will panic. But panics
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// will not be triggered at the time of invoking
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// the methods. They will be triggered on
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// dereferencing nil pointers in the method bodies.
</span><span style="color:#75715e"></span>	<span style="color:#75715e">/*
</span><span style="color:#75715e">	((Slice)(nil)).Modify(0, true)
</span><span style="color:#75715e">	((*Slice)(nil)).Append(true)
</span><span style="color:#75715e">	*/</span>
}
</code></pre></div><p>In fact, the above implementation of the Append method is not perfect, it should be modified as the following one.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Slice</span>) <span style="color:#a6e22e">Append</span>(<span style="color:#a6e22e">x</span> <span style="color:#66d9ef">bool</span>) {
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">p</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#f92672">*</span><span style="color:#a6e22e">p</span> = []<span style="color:#66d9ef">bool</span>{<span style="color:#a6e22e">x</span>}
		<span style="color:#66d9ef">return</span>
	}
	<span style="color:#f92672">*</span><span style="color:#a6e22e">p</span> = append(<span style="color:#f92672">*</span><span style="color:#a6e22e">p</span>, <span style="color:#a6e22e">x</span>)
}
</code></pre></div><p>*new(T) Results a Nil T Value if the Zero Value of Type T Is Represented With the Predeclared nil Identifier
Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#f92672">*</span>new(<span style="color:#f92672">*</span><span style="color:#66d9ef">int</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>)         <span style="color:#75715e">// true
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#f92672">*</span>new([]<span style="color:#66d9ef">int</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>)        <span style="color:#75715e">// true
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#f92672">*</span>new(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">int</span>]<span style="color:#66d9ef">bool</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>) <span style="color:#75715e">// true
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#f92672">*</span>new(<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">string</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>)  <span style="color:#75715e">// true
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#f92672">*</span>new(<span style="color:#66d9ef">func</span>()) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>)       <span style="color:#75715e">// true
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#f92672">*</span>new(<span style="color:#66d9ef">interface</span>{}) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span>)  <span style="color:#75715e">// true
</span><span style="color:#75715e"></span>}
</code></pre></div><h3 id="summary">Summary</h3>
<p>In Go, for simplicity and convenience, nil is designed as an identifier which can be used to represent the zero values of some kinds of types. It is not a single value. It can represent many values with different memory layouts.</p>
<h3 id="参考资料">参考资料</h3>
<ul>
<li><a href="https://go101.org/article/nil.html">nils in Go</a></li>
</ul>

  </div>
</article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://example.org/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
     - 
    2021<span class="heart"><i class="iconfont icon-heart"></i></span><span>olOwOlo</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>








</body>
</html>
