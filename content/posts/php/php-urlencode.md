---
title: "Php Urlencode"
date: 2021-08-23T15:42:26+08:00
draft: false
---

### urlencode

根据官方文档：

```php    
string urlencode(string  $str )
```

此函数便于将字符串编码并将其用于 URL 的请求部分，同时它还便于将变量传递给下一页。

返回字符串，此字符串中除了`-_.` 之外的所有非字母数字字符都将被替换成百分号`%`后跟两位十六进制数，空格则编码为加号`+`。

此编码与 WWW 表单 POST 数据的编码方式是一样的，同时与 application/x-www-form-urlencoded 的媒体类型编码方式一样。

由于历史原因，此编码在将空格编码为加号（+）方面与RFC1738 编码不同。 

解决方法：

使用rawurlencode进行编码

```php    
string rawurlencode(string  $str )
```

根据 RFC 3986编码指定的字符。 

返回字符串，此字符串中除了-_. 之外的所有非字母数字字符都将被替换成百分号（%）后跟两位十六进制数。这是在RFC 3986 中描述的编码，是为了保护原义字符以免其被解释为特殊的URL定界符，同时保护 URL格式以免其被传输媒体（像一些邮件系统）使用字符转换时弄乱。


### 特殊字符

项目中有一个接口是用GET方法接收参数的，测试的时候发现当URL的参数中出现 + 号的时候，传到后端 + 号全都变成了空格了。
然后从网上找到了原因：URL参数中是不能出现+ % # & = ? /等特殊字符的，因为这些字符在URL中有默认的含义，比如&在URL中表示参数间的分隔符，如果不将&转义而直接放在GET请求的参数里，后端的Tomcat就会以这个&为分隔符将参数拆分掉。
如果要传递这些特殊字符给后端，需要将它们转义。转码的格式为：%加字符的ASCII码，即一个百分号%，后面跟对应字符的ASCII（16进制）码值。例如 +号的编码值是"%2B"。

下表中列出了一些URL特殊符号及编码：

```
特殊字符             在URL中的默认含义               转义码
#                   表示书签                        %23
&                   URL 中指定的参数间的分隔符       %26
%                   指定特殊字符                    %25
=                   URL 中指定参数的值	            %3D
+                   URL 中+号表示空格               %2B
空格                                               %20
/                   分隔目录和子目录                %2F
?                   分隔实际的 URL 和参数           %3F

```


### 参考资料
- https://www.php.net/manual/zh/function.urlencode.php